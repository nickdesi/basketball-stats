{
    auto_https off
    admin off
    persist_config off
}

:{$PORT} {
    root * dist
    file_server

    # Never cache index.html so updates are immediate
    @html {
        path /
        path /index.html
        path /sw.js
        path /registerSW.js
        path /manifest.webmanifest
        path /workbox-*
    }
    header @html Cache-Control "no-cache, no-store, must-revalidate"
    header @html Pragma "no-cache"
    header @html Expires "0"

    # Cache assets (images, js, css) that have hashes in filenames
    @assets {
        path /assets/*
    }
    header @assets Cache-Control "public, max-age=31536000, immutable"

    # Support for Single Page Application (SPA) routing
    try_files {path} /index.html
}
